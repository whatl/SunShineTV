# éƒ¨ç½²è„šæœ¬ä½¿ç”¨è¯´æ˜

## ğŸ“ æ–‡ä»¶ç»“æ„

```
scripts/deploy/
â”œâ”€â”€ build.sh                 # ä¸»æ„å»ºè„šæœ¬ï¼ˆæ‰§è¡Œè¿™ä¸ªï¼‰
â”œâ”€â”€ build-docker.sh         # Docker æ„å»ºè„šæœ¬
â”œâ”€â”€ .env.docker.example     # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ docker-compose.yml      # Docker Compose é…ç½®
â”œâ”€â”€ docker-deploy.sh        # æœåŠ¡å™¨éƒ¨ç½²è„šæœ¬
â””â”€â”€ README.md              # éƒ¨ç½²è¯´æ˜æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### 1. æœ¬åœ°æ„å»ºéƒ¨ç½²åŒ…

åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œï¼š

```bash
cd scripts/deploy
./build.sh
```

æ„å»ºå®Œæˆåä¼šåœ¨ `output/` ç›®å½•ç”Ÿæˆï¼š
- `sunshinetv-docker-YYYYMMDD-HHMMSS.zip` - éƒ¨ç½²åŒ…
- `deploy-docker-YYYYMMDD-HHMMSS/` - è§£å‹åçš„ç›®å½•

### 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨

```bash
# ä¸Šä¼ éƒ¨ç½²åŒ…
scp output/sunshinetv-docker-*.zip user@server:/path/to/deploy/
```

### 3. æœåŠ¡å™¨éƒ¨ç½²

```bash
# ç™»å½•æœåŠ¡å™¨
ssh user@server

# è§£å‹
unzip sunshinetv-docker-*.zip
cd deploy-docker-*/

# é…ç½®ç¯å¢ƒå˜é‡
cp .env.example .env
vi .env  # ä¿®æ”¹é…ç½®

# å¯åŠ¨æœåŠ¡
./docker-deploy.sh start
```

### 4. éªŒè¯éƒ¨ç½²

è®¿é—®ï¼šhttp://æœåŠ¡å™¨IP:3000

æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
./docker-deploy.sh logs
```

## ğŸ”§ æœåŠ¡ç®¡ç†å‘½ä»¤

```bash
./docker-deploy.sh start    # å¯åŠ¨æœåŠ¡
./docker-deploy.sh stop     # åœæ­¢æœåŠ¡
./docker-deploy.sh restart  # é‡å¯æœåŠ¡
./docker-deploy.sh logs     # æŸ¥çœ‹æ—¥å¿—
./docker-deploy.sh rebuild  # é‡æ–°æ„å»º
./docker-deploy.sh status   # æŸ¥çœ‹çŠ¶æ€
```

## ğŸ“‹ ç¯å¢ƒå˜é‡é…ç½®

å¿…é¡»ä¿®æ”¹çš„é…ç½®é¡¹ï¼ˆåœ¨ .env æ–‡ä»¶ä¸­ï¼‰ï¼š

```env
# ç®¡ç†å‘˜è´¦å·
USERNAME=admin
PASSWORD=ä¿®æ”¹ä¸ºå¼ºå¯†ç 

# ç«™ç‚¹åç§°
NEXT_PUBLIC_SITE_NAME=ä½ çš„ç«™ç‚¹åç§°

# å­˜å‚¨é…ç½®ï¼ˆä½¿ç”¨ Kvrocksï¼‰
NEXT_PUBLIC_STORAGE_TYPE=redis
REDIS_HOST=kvrocks
REDIS_PORT=6666
```

## ğŸ³ æœåŠ¡è¯´æ˜

éƒ¨ç½²åä¼šå¯åŠ¨ä¸¤ä¸ªå®¹å™¨ï¼š

1. **sunshinetv** - ä¸»åº”ç”¨
   - ç«¯å£ï¼š3000
   - å¥åº·æ£€æŸ¥ï¼šhttp://localhost:3000/api/health

2. **sunshinetv-kvrocks** - æ•°æ®å­˜å‚¨
   - ç«¯å£ï¼š6666
   - æ•°æ®æŒä¹…åŒ–ï¼šDocker Volume

## ğŸ’¾ æ•°æ®å¤‡ä»½ä¸æ¢å¤

### å¤‡ä»½æ•°æ®

```bash
docker run --rm \
  -v sunshinetv_kvrocks-data:/data \
  -v $(pwd):/backup \
  alpine tar czf /backup/kvrocks-backup.tar.gz -C /data .
```

### æ¢å¤æ•°æ®

```bash
docker run --rm \
  -v sunshinetv_kvrocks-data:/data \
  -v $(pwd):/backup \
  alpine tar xzf /backup/kvrocks-backup.tar.gz -C /data
```

## â“ å¸¸è§é—®é¢˜

### ç«¯å£è¢«å ç”¨

ä¿®æ”¹ `docker-compose.yml`ï¼š
```yaml
services:
  app:
    ports:
      - "8080:3000"  # æ”¹æˆå…¶ä»–ç«¯å£
```

### æŸ¥çœ‹è¯¦ç»†æ—¥å¿—

```bash
docker-compose logs -f app
docker-compose logs -f kvrocks
```

### å®Œå…¨é‡æ–°éƒ¨ç½²

```bash
# åœæ­¢å¹¶åˆ é™¤æ‰€æœ‰æ•°æ®
docker-compose down -v

# é‡æ–°å¯åŠ¨
docker-compose up -d
```
